<!DOCTYPE html>
<html>
  <head>
    <title>Notification Center</title>
    <style>
      * {
        margin: 0;
        padding: 0;
      }
      body {
        font-family: Helvetica, sans-serif;
        color: #2e2e2e;
        background: #fff;
      }
      a {
        text-decoration: none;
        color: inherit;
      }
      #box {
        width: 400px;
      }
      h1, h2, h3 {
        font-weight: normal;
      }
      h1 {
        margin: 10px 0 0 5px;
        padding-left: 30px;
        background: url(http://z.jbalogh.me/logo.png) left top no-repeat;
        font-size: 28px;
      }
      h2 {
        padding: 5px 0 0 10px;
        background: #dadada;
        font-size: 18px;
      }
      h2 img {
        width: 16px;
        height: 16px;
        margin-right: 5px;
        border-radius: 4px;
      }
      h3 {
        font-size: 1em;
        font-weight: bold;
        padding: 12px 0 6px;
      }
      ul {
        list-style-type: none;
      }
      .message {
        padding: 0 5px 0 36px;
        font-size: 12px;
      }
      .message:hover {
        background: #fffcda;
      }
      .message a {
        display: block;
        padding-bottom: 6px;
        border-bottom: 2px solid #dadada;
      }
      .message:last-child a {
        padding-bottom: 6px;
        border: none;
      }
      time {
        margin-right: 6px;
        font-size: 10px;
        font-weight: normal;
        float: right;
      }
      .message p {
        clear: both;
        width: 80%;
      }
    </style>
    <script>
      var icons = {
        "facebook.com": "http://a3.mzstatic.com/us/r1000/086/Purple/03/df/55/mzl.ziwhldlf.175x175-75.jpg",
        "foursquare.com": "https://static-s.foursquare.com/img/touch-icon-ipad-1d5a99e90171f6a0cc2f74920ec24021.png",
        "twitter.com": "https://si0.twimg.com/twitter-mobile/d23caade6d08e27a428c5e60a1b67371ccaf4569/images/apple-touch-icon-114.png",
        "nytimes.com": "http://graphics8.nytimes.com/webapps/skimmer/2.4/images/skmr_256.png",
        "tumblr.com": "http://assets.tumblr.com/images/apple_touch_icon.png"
      };
      var now = new Date();
      var notifications = [
        {title: "Holly checked in to The Internet",
         time: new Date(now - 1000 * 60 * 50),
         site: "foursquare.com"},
        {title: "@potch replied to one of your Tweets!",
         body: "@jeffbalogh OH GOD THE BASS IS VIBRATING MY INSIDES WHAT HAVE YOU DONE",
         time: new Date(now - 1000 * 60 * 60 * 4),
         site: "twitter.com"},
        {title: "Today's top headlines",
         body: "Exerio. To core is assum eum aut ut minisitas autas moluptaspiet",
         time: new Date(now - 1000 * 60 * 60 * 8),
         site: "nytimes.com"},
        {title: "@tofumatt retweeted one of your Tweets!",
         body: "BrowserID is an awesome effort and it's a real shame that the marketing types had to create this confusion.",
         time: new Date(now - 1000 * 60 * 60 * 26),
         site: "twitter.com"},
        {title: "New blog from Sean Martell",
         body: "Mozilla in Logos: 65 logos from 2006 - present",
         time: new Date(now - 1000 * 60 * 10),
         site: "tumblr.com"},
        {title: "People are talking about you on Facebook",
         time: new Date(now - 1000 * 60 * 30),
         site: "facebook.com"},
        {title: "Sarah commented on your photo on Facebook",
         body: "LOL",
         time: new Date(now - 1000 * 60 * 75),
         site: "facebook.com"},
        {title: "Bret wants to be friends on Facebook",
         body: "Click here to confirm the request.",
         time: new Date(now - 1000 * 60 * 60 * 9),
         site: "facebook.com"}
      ];
    </script>
  </head>
  <body>
    <div id="box">
      <h1>Firefox Notifications</h1>
      <ul id="notifications">
      </ul>
    </div>
    <script src="http://z.jbalogh.me/pretty.js"></script>
    <script src="https://raw.github.com/janl/mustache.js/master/mustache.js"></script>
    <script id="template" type="template">
      {{#sites}}
      <li>
        <a href="http://{{domain}}"><h2><img src="{{icon}}"> {{name}}</h2></a>
        <ul>
          {{#notifications}}
          <li class="message">
            <a href="http://{{site}}#{{title}}">
              <h3>{{title}} <time>{{prettyTime}}</time></h3>
              {{#body}}
              <p>{{body}}</p>
              {{/body}}
            </a>
          </li>
          {{/notifications}}
        </ul>
      </li>
      {{/sites}}
    </script>
    <script>
      var list = document.getElementById('notifications'),
          template = document.getElementById('template').textContent,
          view = {sites: []};


      notifications.sort(function(a, b) {
        if (a.time < b.time) return 1;
        if (a.time > b.time) return -1;
        return 0;
      });

      notifications.forEach(function(e) {
        // Clean up the time element.
        e.prettyTime = prettyDate(e.time);
      });

      // notifications.groupBy('site')
      groups = {};
      notifications.forEach(function(e) {
        var key = e.site;
        (groups[key] || (groups[key] = [])).push(e);
      });


      for (var domain in groups) {
        var site = {domain: domain, name: domain, icon: icons[domain]};
        site.notifications = groups[domain];
        view.sites.push(site);
      }

      list.innerHTML = Mustache.render(template, view);
    </script>
  </body>
</html>
